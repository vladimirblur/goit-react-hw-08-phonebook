(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[6],{104:function(e,t,n){},134:function(e,t,n){"use strict";n.r(t);var r,c,a,s=n(0),u=n.n(s),i=n(50),o=n.n(i),l=n(38),d=(n(104),n(23)),j=n(86),b=n(11),f=n(36),p=n(87),h=n.n(p),O=n(4),g=n(24),x=n(19),v=n(74),m=n(22),k=Object(b.d)([],(r={},Object(O.a)(r,m.fetchContacts.fulfilled,(function(e,t){return t.payload})),Object(O.a)(r,m.addContact.fulfilled,(function(e,t){var n=t.payload;return[].concat(Object(g.a)(e),[n])})),Object(O.a)(r,m.deleteContact.fulfilled,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),r)),C=Object(b.d)("",Object(O.a)({},v.filterChange,(function(e,t){return t.payload.filter}))),y=Object(b.d)(!1,(c={},Object(O.a)(c,m.addContact.pending,(function(){return!0})),Object(O.a)(c,m.addContact.fulfilled,(function(){return!1})),Object(O.a)(c,m.addContact.rejected,(function(){return!1})),Object(O.a)(c,m.deleteContact.pending,(function(){return!0})),Object(O.a)(c,m.deleteContact.fulfilled,(function(){return!1})),Object(O.a)(c,m.deleteContact.rejected,(function(){return!1})),Object(O.a)(c,m.fetchContacts.pending,(function(){return!0})),Object(O.a)(c,m.fetchContacts.fulfilled,(function(){return!1})),Object(O.a)(c,m.fetchContacts.rejected,(function(){return!1})),c)),w=Object(b.d)(null,(a={},Object(O.a)(a,m.fetchContacts.rejected,(function(e,t){return t.payload})),Object(O.a)(a,m.fetchContacts.pending,(function(){return null})),a)),I=Object(x.b)({items:k,filter:C,loading:y,error:w}),L=n(25),U={key:"auth",storage:h.a,whitelist:["token"]},W=Object(b.a)({reducer:{auth:Object(f.g)(U,L.b),contacts:I},middleware:function(e){return e({serializableCheck:{ignoredActions:[f.a,f.f,f.b,f.c,f.d,f.e]}})},devTools:!1}),F={store:W,persistor:Object(f.h)(W)},N=n(5),A=n(151),T=n(93),V=n(160),z=n(1);function E(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/":n;return Object(d.c)(L.c.getIsLoggedIn)?t:Object(z.jsx)(N.a,{to:r})}function _(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,c=e.redirectTo,a=void 0===c?"/":c;return Object(d.c)(L.c.getIsLoggedIn)&&r?Object(z.jsx)(N.a,{to:a}):t}var S=n(164),P=n(162),G=n(166),M=n(163),R=n(158);function B(e){var t=e.isLoggedIn;return Object(z.jsxs)(A.a,{sx:{display:{xs:"flex",md:"flex"},flexGrow:1,alignItems:"center"},component:"nav",children:[Object(z.jsxs)(M.a,{sx:{display:"flex",flexGrow:t?0:1},children:[Object(z.jsx)(R.a,{children:Object(z.jsx)(l.c,{to:"/",className:function(e){return e.isActive?"activeLink":"link"},children:"Home"})}),t&&Object(z.jsxs)(R.a,{children:[" ",Object(z.jsx)(l.c,{to:"/contacts",className:function(e){return e.isActive?"activeLink":"link"},children:"Contacts"})]})]}),!t&&Object(z.jsxs)(M.a,{sx:{display:"flex"},children:[Object(z.jsx)(R.a,{sx:{width:"auto"},children:Object(z.jsx)(l.c,{to:"/register",className:function(e){return e.isActive?"activeLink":"link"},children:"Sign up"})}),Object(z.jsx)(R.a,{sx:{width:"auto"},children:Object(z.jsx)(l.c,{to:"/login",className:function(e){return e.isActive?"activeLink":"link"},children:"Log In"})})]})]})}var J=n(161),q=n(67),D=n.n(q),H=Object(T.a)({palette:{primary:{main:"#01579b",contrastText:"#f3e5f5"},secondary:{main:"#f44336",contrastText:"#f3e5f5"}}});function K(){var e=Object(d.b)(),t=Object(d.c)(L.c.getUserName);return Object(z.jsx)("div",{className:D.a.container,children:Object(z.jsxs)(V.a,{theme:H,children:[Object(z.jsx)("span",{className:D.a.name,children:"Welcome ".concat(t)}),Object(z.jsx)(J.a,{type:"button",onClick:function(){return e(L.a.logOut())},variant:"contained",sx:{mt:3,mb:2},children:"Log out"})]})})}function Q(){var e=Object(d.c)(L.c.getIsLoggedIn);return Object(z.jsx)(S.a,{position:"static",children:Object(z.jsx)(P.a,{maxWidth:"xl",children:Object(z.jsxs)(G.a,{disableGutters:!0,sx:{flexDirection:{xs:e?"row":"row-reverse",md:"row"}},children:[Object(z.jsx)(B,{isLoggedIn:e}),e&&Object(z.jsx)(K,{})]})})})}var X=Object(T.a)({palette:{primary:{main:"#263238"},secondary:{main:"#01579b"}}}),Y=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,228))})),Z=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,224))})),$=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8)]).then(n.bind(null,225))})),ee=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(5)]).then(n.bind(null,229))}));var te=function(){var e=Object(d.b)(),t=Object(d.c)(L.c.getIsFetchingCurrentUser);return Object(s.useEffect)((function(){e(L.a.fetchCurrentUser())}),[e]),Object(z.jsx)(V.a,{theme:X,children:Object(z.jsxs)("div",{className:"App",children:[Object(z.jsx)(Q,{}),Object(z.jsx)(A.a,{component:"main",children:t?Object(z.jsx)("h1",{children:"Loading..."}):Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(s.Suspense,{fallback:Object(z.jsx)("div",{children:"Loading"}),children:Object(z.jsxs)(N.d,{children:[Object(z.jsx)(N.b,{path:"/",element:Object(z.jsx)(_,{children:Object(z.jsx)(Y,{})})}),Object(z.jsx)(N.b,{path:"/register",element:Object(z.jsx)(_,{restricted:!0,children:Object(z.jsx)($,{})})}),Object(z.jsx)(N.b,{path:"/login",element:Object(z.jsx)(_,{redirectTo:"/contacts",restricted:!0,children:Object(z.jsx)(ee,{})})}),Object(z.jsx)(N.b,{path:"/contacts",element:Object(z.jsx)(E,{redirectTo:"/login",children:Object(z.jsx)(Z,{})})})]})})})})]})})};o.a.render(Object(z.jsx)(u.a.StrictMode,{children:Object(z.jsx)(l.a,{children:Object(z.jsx)(d.a,{store:F.store,children:Object(z.jsx)(j.a,{loading:null,persistor:F.persistor,children:Object(z.jsx)(te,{})})})})}),document.getElementById("root"))},22:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchContacts",(function(){return o})),n.d(t,"addContact",(function(){return l})),n.d(t,"deleteContact",(function(){return d}));var r=n(20),c=n.n(r),a=n(34),s=n(29),u=n.n(s),i=n(11);u.a.defaults.baseURL="https://connections-api.herokuapp.com";var o=Object(i.c)("contacts/fecthContacts",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,u.a.get("/contacts");case 4:return a=e.sent,s=a.data,e.abrupt("return",s);case 9:if(e.prev=9,e.t0=e.catch(1),400!==(e.t0.response?e.t0.response.status:500)){e.next=18;break}return i="Error fecthing contacts",alert(i),e.abrupt("return",r(i));case 18:return e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),l=Object(i.c)("contacts/addContact",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,u.a.post("/contacts",t);case 4:return a=e.sent,s=a.data,e.abrupt("return",s);case 9:if(e.prev=9,e.t0=e.catch(1),400!==(e.t0.response?e.t0.response.status:500)){e.next=18;break}return i="Error adding contacts",alert(i),e.abrupt("return",r(i));case 18:return e.abrupt("return",r(e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),d=Object(i.c)("contacts/deleteContact",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,u.a.delete("/contacts/".concat(t)),e.abrupt("return",t);case 6:e.prev=6,e.t0=e.catch(1),r(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}())},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return x}));var r=n(20),c=n.n(r),a=n(34),s=n(29),u=n.n(s),i=n(11);u.a.defaults.baseURL="https://connections-api.herokuapp.com";var o,l=function(e){u.a.defaults.headers.common.Authorization="Bearer ".concat(e)},d=function(){u.a.defaults.headers.common.Authorization=""},j=Object(i.c)("auth/signUp",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,u.a.post("/users/signup",t);case 4:return a=e.sent,s=a.data,l(s.token),e.abrupt("return",s);case 10:if(e.prev=10,e.t0=e.catch(1),400!==(e.t0.response?e.t0.response.status:500)){e.next=19;break}return i="This email is already taken",alert(i),e.abrupt("return",r(i));case 19:return e.abrupt("return",r(e.t0.message));case 20:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),b=Object(i.c)("auth/login",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,u.a.post("/users/login",t);case 4:return a=e.sent,s=a.data,l(s.token),e.abrupt("return",s);case 10:if(e.prev=10,e.t0=e.catch(1),400!==(e.t0.response?e.t0.response.status:500)){e.next=19;break}return i="Email or password is incorrect",alert(i),e.abrupt("return",r(i));case 19:return e.abrupt("return",r(e.t0.message));case 20:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),f=Object(i.c)("auth/logout",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,u.a.post("/users/logout");case 4:d(),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),p=Object(i.c)("auth/refresh",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState(),null!==(a=r.auth.token)){e.next=4;break}return e.abrupt("return",n.rejectWithValue());case 4:return l(a),e.prev=5,e.next=8,u.a.get("users/current");case 8:return s=e.sent,i=s.data,e.abrupt("return",i);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",n.rejectWithValue(e.t0));case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}()),h={signUp:j,logOut:f,logIn:b,fetchCurrentUser:p},O={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getIsFetchingCurrentUser:function(e){return e.auth.isFetchingCurrentUser},getError:function(e){return e.auth.error}},g=n(4),x=Object(i.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrentUser:!1,error:null},extraReducers:(o={},Object(g.a)(o,h.signUp.fulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),Object(g.a)(o,h.signUp.rejected,(function(e,t){var n=t.payload;e.error=n})),Object(g.a)(o,h.logIn.fulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),Object(g.a)(o,h.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(g.a)(o,h.fetchCurrentUser.pending,(function(e){e.isFetchingCurrentUser=!0})),Object(g.a)(o,h.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isFetchingCurrentUser=!1})),Object(g.a)(o,h.fetchCurrentUser.rejected,(function(e){e.isFetchingCurrentUser=!1})),o)}).reducer},67:function(e,t,n){e.exports={container:"UserMenu_container__2IFyb",name:"UserMenu_name__1qacW"}},74:function(e,t,n){"use strict";n.r(t),n.d(t,"filterChange",(function(){return c}));var r=n(11),c=Object(r.b)("contacts/changeFilter",(function(e){return{payload:{filter:e}}}))}},[[134,7,9]]]);
//# sourceMappingURL=main.92d7ea6d.chunk.js.map